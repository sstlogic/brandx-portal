{"version":3,"sources":["webpack:///./src/composables/useLoader/useLoader.ts","webpack:///./src/views/ProfilePage/ProfilePasswordPage.vue?d69c","webpack:///./src/views/ProfilePage/ProfilePasswordPage.vue","webpack:///./src/views/ProfilePage/ProfilePasswordPage.vue?99b4","webpack:///./src/views/ProfilePage/ProfilePasswordPage.vue?b307","webpack:///./src/composables/useValidation/useValidation.ts"],"names":["config","loading","initial","withLoader","callback","value","Promise","resolve","setTimeout","result","delay","render","_vm","this","_h","$createElement","_c","_self","model","$$v","valid","expression","attrs","isCurrentPasswordVisible","icons","mdiEyeOffOutline","mdiEyeOutline","rules","required","errors","currentPassword","on","$event","formData","$set","isPasswordVisible","minLength","password","staticClass","reset","_v","_e","staticRenderFns","components","BaseButton","name","setup","success","useApi","post","useRouter","router","useStatus","setMessage","Password","useLoader","mapErrors","catch","error","then","response","push","routeNames","dashboard","mdi","component","VForm","VSpacer","VTextField","buildObject","obj","Object","entries","key","resetErrors","status","Error","message","data"],"mappings":"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","file":"js/chunk-2c2c1169.a76b3f5f.js","sourcesContent":["import { ref } from '@/plugins/composition';\n\ntype UseLoaderConfig = { delay?: number; initial?: boolean };\n\nexport const useLoader = (config?: UseLoaderConfig) => {\n  const loading = ref(config?.initial ?? false);\n\n  const withLoader = async (callback: () => unknown) => {\n    loading.value = true;\n\n    return new Promise((resolve) => {\n      setTimeout(async () => {\n        let result;\n\n        try {\n          result = await callback();\n        } catch (e) {\n          loading.value = false;\n        }\n\n        loading.value = false;\n        resolve(result);\n      }, config?.delay ?? 0);\n    });\n  };\n\n  return { loading, withLoader };\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('v-form',{model:{value:(_vm.valid),callback:function ($$v) {_vm.valid=$$v},expression:\"valid\"}},[_c('v-text-field',{attrs:{\"dense\":\"\",\"outlined\":\"\",\"type\":_vm.isCurrentPasswordVisible ? 'text' : 'password',\"label\":\"Current Password\",\"append-icon\":_vm.isCurrentPasswordVisible ? _vm.icons.mdiEyeOffOutline : _vm.icons.mdiEyeOutline,\"rules\":[_vm.rules.required],\"error-messages\":_vm.errors.currentPassword},on:{\"click:append\":function($event){_vm.isCurrentPasswordVisible = !_vm.isCurrentPasswordVisible}},model:{value:(_vm.formData.currentPassword),callback:function ($$v) {_vm.$set(_vm.formData, \"currentPassword\", $$v)},expression:\"formData.currentPassword\"}}),_c('v-text-field',{attrs:{\"dense\":\"\",\"outlined\":\"\",\"type\":_vm.isPasswordVisible ? 'text' : 'password',\"label\":\"New Password\",\"append-icon\":_vm.isPasswordVisible ? _vm.icons.mdiEyeOffOutline : _vm.icons.mdiEyeOutline,\"rules\":[_vm.rules.required, _vm.rules.minLength(8)],\"error-messages\":_vm.errors.password},on:{\"click:append\":function($event){_vm.isPasswordVisible = !_vm.isPasswordVisible}},model:{value:(_vm.formData.Password),callback:function ($$v) {_vm.$set(_vm.formData, \"Password\", $$v)},expression:\"formData.Password\"}})],1),_c('div',{staticClass:\"d-flex\"},[_c('v-spacer'),_c('base-button',{attrs:{\"black\":\"\",\"disabled\":!_vm.valid,\"loading\":_vm.loading},on:{\"click\":_vm.reset}},[_vm._v(\"Reset\")])],1),(_vm.success)?_c('div',{staticClass:\"mt-2\"},[_vm._v(\"Your password has been reset.\")]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport BaseButton from '@/components/base/BaseButton.vue';\nimport { defineComponent, reactive, ref } from '@/plugins/composition';\nimport { mdiEyeOffOutline, mdiEyeOutline } from '@mdi/js';\nimport { useFormValidation, rules } from '@/composables/useValidation';\nimport { useLoader } from '@/composables/useLoader';\nimport { useApi } from '@/composables/useApi';\nimport { snakeKeys } from '@/utils/case';\nimport { useStatus } from '@/composables/useStatus';\nimport { routeNames } from '@/router/routeNames';\nimport { useRouter } from '@/router/useRouter';\n\nexport default defineComponent({\n  components: { BaseButton },\n  name: 'ProfilePasswordPage',\n  setup() {\n    const valid = ref(false);\n    const isCurrentPasswordVisible = ref(false);\n    const isPasswordVisible = ref(false);\n    const success = ref(false);\n    const { post } = useApi();\n    const { router } = useRouter();\n    const { setMessage } = useStatus();\n\n    const formData = reactive({\n      currentPassword: '',\n      Password: '',\n    });\n\n    const { loading, withLoader } = useLoader();\n\n    const { errors, mapErrors } = useFormValidation(formData);\n\n    const reset = async () =>\n      withLoader(async () => {\n        await post('/update-password', snakeKeys(formData))\n          .catch((error) => mapErrors(error))\n          .then((response) => {\n            if (response) {\n              formData.currentPassword = '';\n              formData.Password = '';\n              success.value = true;\n              setMessage('Password Updated. Redirecting to Dashboard...');\n              setTimeout(() => {\n                router.push({ name: routeNames.dashboard });\n              }, 1000);\n            }\n          });\n      });\n\n    return {\n      valid,\n      formData,\n      isCurrentPasswordVisible,\n      isPasswordVisible,\n      icons: {\n        mdiEyeOffOutline,\n        mdiEyeOutline,\n      },\n      errors,\n      rules,\n      loading,\n      reset,\n      success,\n    };\n  },\n});\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--15-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--15-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfilePasswordPage.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--15-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--15-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfilePasswordPage.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ProfilePasswordPage.vue?vue&type=template&id=d2e76720&\"\nimport script from \"./ProfilePasswordPage.vue?vue&type=script&lang=ts&\"\nexport * from \"./ProfilePasswordPage.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VForm,VSpacer,VTextField})\n","import { AxiosError } from 'axios';\nimport { camel } from '@/utils/string';\nimport { ref, watch } from '@/plugins/composition';\n\ntype ErrorObject = {\n  [key: string]: string[];\n};\n\ntype FormData = {\n  [key: string]: unknown;\n};\n\n// type ErrorResponse = {\n//   [key: string]: unknown;\n// };\n\ntype ErrorsObject<T> = {\n  [K in keyof T]: T[K];\n};\n\nexport const useFormValidation = <T extends FormData>(formData: T) => {\n  const valid = ref(false);\n\n  const buildObject = () => {\n    const obj = {} as ErrorObject;\n    for (const [key] of Object.entries(formData)) {\n      obj[key] = [];\n    }\n    return obj;\n  };\n\n  const errors = ref<ErrorsObject<T>>(buildObject() as T);\n\n  const resetErrors = () => {\n    errors.value = buildObject();\n  };\n\n  const mapErrors = (error: AxiosError) => {\n    if (error.response?.status === 422) {\n      for (const [key, value] of Object.entries(error.response.data.errors)) {\n        errors.value[camel(key)].push(...(value as string[]));\n      }\n    } else {\n      throw new Error(error.message);\n    }\n  };\n\n  watch(formData, () => resetErrors());\n\n  return {\n    errors,\n    mapErrors,\n    valid,\n  };\n};\n"],"sourceRoot":""}