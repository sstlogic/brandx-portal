{"version":3,"sources":["webpack:///./src/views/ProfilePage/ProfilePasswordPage.vue?d69c","webpack:///./src/views/ProfilePage/ProfilePasswordPage.vue","webpack:///./src/views/ProfilePage/ProfilePasswordPage.vue?99b4","webpack:///./src/views/ProfilePage/ProfilePasswordPage.vue?b307","webpack:///./src/composables/useValidation/useValidation.ts"],"names":["render","_vm","this","_h","$createElement","_c","_self","model","value","callback","$$v","valid","expression","attrs","isCurrentPasswordVisible","icons","mdiEyeOffOutline","mdiEyeOutline","rules","required","errors","currentPassword","on","$event","formData","$set","isPasswordVisible","minLength","password","staticClass","loading","reset","_v","_e","staticRenderFns","components","BaseButton","name","setup","success","useApi","post","useRouter","router","useStatus","setMessage","Password","useLoader","withLoader","mapErrors","catch","error","then","response","setTimeout","push","routeNames","dashboard","mdi","component","VForm","VSpacer","VTextField","buildObject","obj","Object","entries","key","resetErrors","status","Error","message","data"],"mappings":"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","file":"js/chunk-e425f88c.69747c46.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('v-form',{model:{value:(_vm.valid),callback:function ($$v) {_vm.valid=$$v},expression:\"valid\"}},[_c('v-text-field',{attrs:{\"dense\":\"\",\"outlined\":\"\",\"type\":_vm.isCurrentPasswordVisible ? 'text' : 'password',\"label\":\"Current Password\",\"append-icon\":_vm.isCurrentPasswordVisible ? _vm.icons.mdiEyeOffOutline : _vm.icons.mdiEyeOutline,\"rules\":[_vm.rules.required],\"error-messages\":_vm.errors.currentPassword},on:{\"click:append\":function($event){_vm.isCurrentPasswordVisible = !_vm.isCurrentPasswordVisible}},model:{value:(_vm.formData.currentPassword),callback:function ($$v) {_vm.$set(_vm.formData, \"currentPassword\", $$v)},expression:\"formData.currentPassword\"}}),_c('v-text-field',{attrs:{\"dense\":\"\",\"outlined\":\"\",\"type\":_vm.isPasswordVisible ? 'text' : 'password',\"label\":\"New Password\",\"append-icon\":_vm.isPasswordVisible ? _vm.icons.mdiEyeOffOutline : _vm.icons.mdiEyeOutline,\"rules\":[_vm.rules.required, _vm.rules.minLength(8)],\"error-messages\":_vm.errors.password},on:{\"click:append\":function($event){_vm.isPasswordVisible = !_vm.isPasswordVisible}},model:{value:(_vm.formData.Password),callback:function ($$v) {_vm.$set(_vm.formData, \"Password\", $$v)},expression:\"formData.Password\"}})],1),_c('div',{staticClass:\"d-flex\"},[_c('v-spacer'),_c('base-button',{attrs:{\"black\":\"\",\"disabled\":!_vm.valid,\"loading\":_vm.loading},on:{\"click\":_vm.reset}},[_vm._v(\"Reset\")])],1),(_vm.success)?_c('div',{staticClass:\"mt-2\"},[_vm._v(\"Your password has been reset.\")]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport BaseButton from '@/components/base/BaseButton.vue';\nimport { defineComponent, reactive, ref } from '@/plugins/composition';\nimport { mdiEyeOffOutline, mdiEyeOutline } from '@mdi/js';\nimport { useFormValidation, rules } from '@/composables/useValidation';\nimport { useLoader } from '@/composables/useLoader';\nimport { useApi } from '@/composables/useApi';\nimport { snakeKeys } from '@/utils/case';\nimport { useStatus } from '@/composables/useStatus';\nimport { routeNames } from '@/router/routeNames';\nimport { useRouter } from '@/router/useRouter';\n\nexport default defineComponent({\n  components: { BaseButton },\n  name: 'ProfilePasswordPage',\n  setup() {\n    const valid = ref(false);\n    const isCurrentPasswordVisible = ref(false);\n    const isPasswordVisible = ref(false);\n    const success = ref(false);\n    const { post } = useApi();\n    const { router } = useRouter();\n    const { setMessage } = useStatus();\n\n    const formData = reactive({\n      currentPassword: '',\n      Password: '',\n    });\n\n    const { loading, withLoader } = useLoader();\n\n    const { errors, mapErrors } = useFormValidation(formData);\n\n    const reset = async () =>\n      withLoader(async () => {\n        await post('/update-password', snakeKeys(formData))\n          .catch((error) => mapErrors(error))\n          .then((response) => {\n            if (response) {\n              formData.currentPassword = '';\n              formData.Password = '';\n              success.value = true;\n              setMessage('Password Updated. Redirecting to Dashboard...');\n              setTimeout(() => {\n                router.push({ name: routeNames.dashboard });\n              }, 1000);\n            }\n          });\n      });\n\n    return {\n      valid,\n      formData,\n      isCurrentPasswordVisible,\n      isPasswordVisible,\n      icons: {\n        mdiEyeOffOutline,\n        mdiEyeOutline,\n      },\n      errors,\n      rules,\n      loading,\n      reset,\n      success,\n    };\n  },\n});\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--15-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--15-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfilePasswordPage.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--15-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--15-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfilePasswordPage.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ProfilePasswordPage.vue?vue&type=template&id=d2e76720&\"\nimport script from \"./ProfilePasswordPage.vue?vue&type=script&lang=ts&\"\nexport * from \"./ProfilePasswordPage.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VForm,VSpacer,VTextField})\n","import { AxiosError } from 'axios';\nimport { camel } from '@/utils/string';\nimport { ref, watch } from '@/plugins/composition';\n\ntype ErrorObject = {\n  [key: string]: string[];\n};\n\ntype FormData = {\n  [key: string]: unknown;\n};\n\n// type ErrorResponse = {\n//   [key: string]: unknown;\n// };\n\ntype ErrorsObject<T> = {\n  [K in keyof T]: T[K];\n};\n\nexport const useFormValidation = <T extends FormData>(formData: T) => {\n  const valid = ref(false);\n\n  const buildObject = () => {\n    const obj = {} as ErrorObject;\n    for (const [key] of Object.entries(formData)) {\n      obj[key] = [];\n    }\n    return obj;\n  };\n\n  const errors = ref<ErrorsObject<T>>(buildObject() as T);\n\n  const resetErrors = () => {\n    errors.value = buildObject();\n  };\n\n  const mapErrors = (error: AxiosError) => {\n    if (error.response?.status === 422) {\n      for (const [key, value] of Object.entries(error.response.data.errors)) {\n        errors.value[camel(key)].push(...(value as string[]));\n      }\n    } else {\n      throw new Error(error.message);\n    }\n  };\n\n  watch(formData, () => resetErrors());\n\n  return {\n    errors,\n    mapErrors,\n    valid,\n  };\n};\n"],"sourceRoot":""}